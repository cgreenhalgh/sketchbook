<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head>







<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Sketcher File Format</title></head><body>
<h1>Sketcher File Format</h1>
This file describes the file format for the sketcher prototype. Not all
features may be implemented/supported in the current version. Current
usage may also differ from intended usage, and I will try to document
this where known.<br>
<h2>Overview</h2>
The file format uses JSON (<a href="http://www.json.org/">http://www.json.org/</a>), and in particular the whole file is a single serialised JSON object. The character encoding - as usual - is UTF-8.<br>
<h2>Requirements</h2>
<p>Supports a paper/sketching metaphor, including freehand lines, text and (imported) images such as photos and maps.</p>
<p>Allows composition of sketches:</p>
<ul>
  <li>as an icon (instantiable, repeated, transformed)</li>
  <li>as a backdrop</li>
</ul>
<p>Allows comments and annotations to be made 'over' sketches, perhaps as a set of switchable overlays (layers).</p>
<p>Allows sketches to be labelled, organised (categorised/tagged, ordered) and annotated (commented on).<br>
</p>
<p>Allows region(s) of a sketch to be identified, labelled ('framed') and shown/talked about.</p>
<p>Allows frames to be organised into sequences, and those sequences,
frames and transitions to described and annotated (commented on). <br>
</p>
<h2>Syntax <br>
</h2>
<h3>Sketcher2 file format</h3>

<span style="font-style: italic;"></span>
<p><span style="font-style: italic;">The complete state of the sketch and editor, as saved</span></p>

state := <span style="font-family: monospace;">{</span> <br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"version": </span>version<span style="font-family: monospace;">,</span> // <span style="font-family: monospace;">"sketcher2.1"</span> as of 2/5/2013<br>

&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"nextId": </span>nextId<sub>int</sub><span style="font-family: monospace;">, </span> // numeric (integer) ID to be allocated to next thing created (of any kind)<br>

&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"sketches": [</span> sketch* <span style="font-family: monospace;">],</span><br>&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"sequences": [</span> sequence* <span style="font-family: monospace;">]</span><br>

<span style="font-family: monospace;"></span><span style="font-family: monospace;">}</span><br>
<p><span style="font-style: italic;">A single sketch, i.e. "page", icon or background.</span></p>


sketch := <span style="font-family: monospace;">{</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"id": </span>id<sub>int</sub><span style="font-family: monospace;">,</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"description": </span>description<sub>string</sub><span style="font-family: monospace;">,</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"elements": [ </span>element*<span style="font-family: monospace;"> ]</span><span style="font-family: monospace;">,</span> // the main sketch contents<br>&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"background": {</span> // optional<br style="font-family: monospace;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"sketchId":</span> id<sub>int</sub><span style="font-family: monospace;">,</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"alpha": </span>opacity<sub>number</sub> // default 1.0 (range 0.0-1.0)<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">}</span><br>


&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"readonly":</span> readonly<sub>boolean</sub><span style="font-family: monospace;">,</span> // default false<br>
<span style="font-family: monospace;">}</span><br>
<span style="font-style: italic;"></span>
<p><span style="font-style: italic;">A single "primitive" drawing element in a sketch.<br>
</span></p>

element := <span style="font-family: monospace;">{</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"id": </span>id<sub>int</sub><span style="font-family: monospace;">,</span><br>
// one of:<br>
&nbsp;&nbsp;&nbsp; &nbsp; <span style="font-family: monospace;">"line": </span>line<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"icon": </span>icon<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"frame": </span>frame<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"image": </span>image<br>

// TODO more<br>
<span style="font-family: monospace;">}</span><br>
<p><span style="font-style: italic;">A single (e.g. hand-drawn) line, which may have multiple segments. Based on paperjs Path.<br>
</span></p>

line := <span style="font-family: monospace;">{</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"lineColor": </span>color<span style="font-family: monospace;">,</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"lineWidth": </span>width<sub>number</sub><span style="font-family: monospace;">, </span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"fillColor": </span>color<span style="font-family: monospace;">,</span> // default: no fill<br>



&nbsp; &nbsp; <span style="font-family: monospace;">"frameStyle": </span><span style="font-family: monospace;">"" </span>| <span style="font-family: monospace;">"border"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"fill"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"border,fill", </span>// default <span style="font-family: monospace;">"border"</span><span style="font-family: monospace;"></span><br>


<span style="font-family: monospace;"></span>

&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"segments": [ </span>segment*<span style="font-family: monospace;"> ]</span><br>
<span style="font-family: monospace;">}</span><br>
<p><span style="font-style: italic;">A point on a Path (again, based
directly on paperjs). Handles specify relative tangents of
incoming/outgoing edge with respect to point.</span> </p>


segment := <span style="font-family: monospace;">{</span><br>


&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"point": { "x": </span>x<sub>number</sub><span style="font-family: monospace;">, "y": </span>y<sub>number</sub> <span style="font-family: monospace;">}, </span>// refer to paper.js Path segment specification<br>


&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"handleIn": { "x": </span>x<sub>number</sub><span style="font-family: monospace;">, "y": </span>y<sub>number</sub><span style="font-family: monospace;"> }, </span><span style="font-family: monospace;"></span>// refer to paper.js Path segment specification<br>


&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"handleOut": { "x": </span>x<sub>number</sub><span style="font-family: monospace;">, "y": </span>y<sub>number</sub><span style="font-family: monospace;"> } </span><span style="font-family: monospace;"></span>// refer to paper.js Path segment specification<br>



<span style="font-family: monospace;">}</span><br>



<span style="font-style: italic;"></span>
<p><span style="font-style: italic;">A color in RGB encoding.</span></p>

<span style="font-style: italic;">
</span>color := <span style="font-family: monospace;">{</span><br>

&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"red": </span>red<sub>number</sub><span style="font-family: monospace;"></span><span style="font-family: monospace;">,</span> // Amount of red, between 0 and 1<br>

&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"green": </span>green<sub>number</sub><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;">,</span> // Amount of green, between 0 and 1<br>

&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"blue": </span>blue<sub>number</sub><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span> // Amount of blue, between 0 and 1<br>

<span style="font-family: monospace;">}</span><br>
<p style="font-style: italic;">An icon, i.e. an instance of another sketch</p>
icon := <span style="font-family: monospace;">{</span><br>&nbsp;&nbsp; <span style="font-family: monospace;">"sketchId": </span>id<sub>number</sub><span style="font-family: monospace;">,</span><br>&nbsp;&nbsp; <span style="font-family: monospace;">"elementId": </span>id<sub>number</sub><span style="font-family: monospace;">,</span> // optional, i.e. if specifically refering to a frame (usually) in another sketch<br>

&nbsp;&nbsp; <span style="font-family: monospace;">"x": </span>x<sub>number</sub><span style="font-family: monospace;">,</span><br>
&nbsp;&nbsp; <span style="font-family: monospace;">"y": </span>y<sub>number</sub><span style="font-family: monospace;">,</span><br>

&nbsp;&nbsp; <span style="font-family: monospace;">"width": </span>width<sub>number</sub><span style="font-family: monospace;">,</span><br>

&nbsp;&nbsp; <span style="font-family: monospace;">"height": </span>height<sub>number</sub><span style="font-family: monospace;">,</span><span style="font-family: monospace;"></span><br>



&nbsp;&nbsp; <span style="font-family: monospace;">"frameStyle": </span><span style="font-family: monospace;">"" </span>| <span style="font-family: monospace;">"border"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"fill"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"border,fill", </span>// default <span style="font-family: monospace;">""</span> (none)<span style="font-family: monospace;"></span><br>

<span style="font-family: monospace;"></span>&nbsp;&nbsp; <span style="font-family: monospace;">"lineColor": </span>color<span style="font-family: monospace;">,</span> // if border, default black<br>




<span style="font-family: monospace;"></span>
&nbsp;&nbsp; <span style="font-family: monospace;">"lineWidth": </span>width<sub>number</sub><span style="font-family: monospace;">,</span> // if border, default 1<br>
&nbsp;&nbsp; <span style="font-family: monospace;">"fillColor": </span>color<span style="font-family: monospace;">,</span> // if fill, default black<br>


&nbsp;&nbsp; <span style="font-family: monospace;">"rescale": </span><span style="font-family: monospace;">"fit" </span>| <span style="font-family: monospace;">"crop"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"stretch"</span><span style="font-family: monospace;"></span><span style="font-family: monospace;">,</span> // default <span style="font-family: monospace;">"fit"</span><br>




&nbsp;&nbsp; <span style="font-family: monospace;">"showLabel": </span><span style="font-family: monospace;">"sketch" </span>| <span style="font-family: monospace;">"frame"</span><span style="font-family: monospace;"> </span>|&nbsp; <span style="font-family: monospace;">"sketch,frame"</span><span style="font-family: monospace;"></span><span style="font-family: monospace;"> </span>|&nbsp; <span style="font-family: monospace;">""</span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;">,</span> // default <span style="font-family: monospace;">""</span> (none)<br>





&nbsp;&nbsp; <span style="font-family: monospace;">"textSize": </span>fontSize<sub>number</sub><span style="font-family: monospace;"> </span>// points<br>


&nbsp;&nbsp; <span style="font-family: monospace;">"textColor": </span>color<span style="font-family: monospace;"></span><br>







&nbsp;&nbsp; <span style="font-family: monospace;">"textVAlign": </span><span style="font-family: monospace;">"above" </span>| <span style="font-family: monospace;">"top"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"middle"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"bottom"</span><span style="font-family: monospace;"></span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"below"</span><span style="font-family: monospace;">,</span> // of label (if any); default "middle"<span style="font-family: monospace;"></span><br>



<span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span>

&nbsp;&nbsp;

<span style="font-family: monospace;">"textHAlign": </span><span style="font-family: monospace;">"left" </span>| <span style="font-family: monospace;">"centre"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"right"</span><span style="font-family: monospace;">,</span> // default "centre"<br>


<span style="font-family: monospace;"></span>

&nbsp;&nbsp; <span style="font-family: monospace;">"textHFit": </span><span style="font-family: monospace;">"wrap" </span>| <span style="font-family: monospace;">"crop"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"scale"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"none"</span><span style="font-family: monospace;">,</span> // default "none"<br>







<span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;">}</span><br>
<p style="font-style: italic;">A frame, i.e. a titled region of interest within a sketch</p>
frame := <span style="font-family: monospace;">{</span><br>
&nbsp;&nbsp; <span style="font-family: monospace;">"description": </span>description<sub>string</sub><span style="font-family: monospace;">,</span><br>
&nbsp;&nbsp; <span style="font-family: monospace;">"x": </span>x<sub>number</sub><span style="font-family: monospace;">,</span><br>

&nbsp;&nbsp; <span style="font-family: monospace;">"y": </span>y<sub>number</sub><span style="font-family: monospace;">,</span><br>


&nbsp;&nbsp; <span style="font-family: monospace;">"width": </span>width<sub>number</sub><span style="font-family: monospace;">,</span><br>


&nbsp;&nbsp; <span style="font-family: monospace;">"height": </span>height<sub>number</sub><br>




&nbsp;&nbsp; <span style="font-family: monospace;">"frameStyle": </span><span style="font-family: monospace;">"" </span>| <span style="font-family: monospace;">"border"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"fill"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"borderfill", </span>// default <span style="font-family: monospace;">""</span> (none)<span style="font-family: monospace;"></span><br>


<span style="font-family: monospace;"></span><span style="font-family: monospace;"></span>&nbsp;&nbsp; <span style="font-family: monospace;">"lineColor": </span>color<span style="font-family: monospace;">,</span> // if border; default black<br>



&nbsp;&nbsp; <span style="font-family: monospace;">"lineWidth": </span>width<sub>number</sub><span style="font-family: monospace;">,</span> // if border; default 1<br>


<span style="font-family: monospace;"></span>&nbsp;&nbsp; <span style="font-family: monospace;">"fillColor": </span>color<span style="font-family: monospace;">,</span> // if fill; default black<br>



<span style="font-family: monospace;"></span>

&nbsp;&nbsp; <span style="font-family: monospace;">"showLabel": </span><span style="font-family: monospace;">"sketch" </span>| <span style="font-family: monospace;">"frame"</span><span style="font-family: monospace;"> </span>|&nbsp; <span style="font-family: monospace;">"sketch,frame"</span><span style="font-family: monospace;"></span><span style="font-family: monospace;"> </span>|&nbsp; <span style="font-family: monospace;">""</span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;">,</span> // default <span style="font-family: monospace;">""</span> (none)<br>





&nbsp;&nbsp; <span style="font-family: monospace;">"textSize": </span>fontSize<sub>number</sub><span style="font-family: monospace;">,</span><span style="font-family: monospace;"> </span>// points<br>


&nbsp;&nbsp; <span style="font-family: monospace;">"textColor": </span>color<span style="font-family: monospace;">,</span> // default black<span style="font-family: monospace;"></span><br>



&nbsp;&nbsp; <span style="font-family: monospace;">"textVAlign": </span><span style="font-family: monospace;">"above" </span>| <span style="font-family: monospace;">"top"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"middle"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"bottom"</span><span style="font-family: monospace;"></span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"below"</span><span style="font-family: monospace;">,</span> // default "middle"<span style="font-family: monospace;"></span><br>





<span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span>

&nbsp;&nbsp; <span style="font-family: monospace;">"textHAlign": </span><span style="font-family: monospace;">"left" </span>| <span style="font-family: monospace;">"centre"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"right"</span><span style="font-family: monospace;">,</span> // default "centre"<br>

<span style="font-family: monospace;"></span>

&nbsp;&nbsp; <span style="font-family: monospace;">"textHFit": </span><span style="font-family: monospace;">"wrap" </span>| <span style="font-family: monospace;">"crop"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"scale"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"none"</span><span style="font-family: monospace;"></span> // default "none"<br>






<span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;">}</span>
<p><span style="font-style: italic;">An image, i.e. as an element within a sketch</span> <br></p>
image := <span style="font-family: monospace;">{</span><br>&nbsp; &nbsp;<span style="font-family: monospace;">"url":&nbsp;</span>url<sub>string</sub><span style="font-family: monospace;">, </span>// for backward compatibility, if url is not set will use value of "dataurl"<br>&nbsp;&nbsp; <span style="font-family: monospace;">"x": </span>x<sub>number</sub><span style="font-family: monospace;">,</span><br>

&nbsp;&nbsp; <span style="font-family: monospace;">"y": </span>y<sub>number</sub><span style="font-family: monospace;">,</span><br>


&nbsp;&nbsp; <span style="font-family: monospace;">"width": </span>width<sub>number</sub><span style="font-family: monospace;">,</span><br>


&nbsp;&nbsp; <span style="font-family: monospace;">"height": </span>height<sub>number</sub><br>




&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"rescale": </span><span style="font-family: monospace;">"fit" </span>| <span style="font-family: monospace;">"crop"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"stretch"</span><span style="font-family: monospace;"></span><span style="font-family: monospace;">,</span> // default fit<span style="font-family: monospace;"></span><br>



<span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;">}</span><p style="font-style: italic;">A line of text</p>text := <span style="font-family: monospace;">{</span><br>
&nbsp;&nbsp; <span style="font-family: monospace;">"content": </span>content<sub>string</sub><span style="font-family: monospace;">,</span><br>
&nbsp;&nbsp; <span style="font-family: monospace;">"x": </span>x<sub>number</sub><span style="font-family: monospace;">,</span><br>
&nbsp;&nbsp; <span style="font-family: monospace;">"y": </span>y<sub>number</sub><span style="font-family: monospace;">,</span><br>


&nbsp;&nbsp; <span style="font-family: monospace;">"width": </span>width<sub>number</sub><span style="font-family: monospace;">,</span><br>



&nbsp;&nbsp; <span style="font-family: monospace;">"height": </span>height<sub>number</sub><br>





&nbsp;&nbsp; <span style="font-family: monospace;">"textSize": </span>fontSize<sub>number</sub><span style="font-family: monospace;"> </span>// points<br>

&nbsp;&nbsp; <span style="font-family: monospace;">"textColor": </span>color<span style="font-family: monospace;"></span><br>



&nbsp;&nbsp; <span style="font-family: monospace;">"frameStyle": </span><span style="font-family: monospace;">"" </span>| <span style="font-family: monospace;">"border"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"fill"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"borderfill", </span>// default <span style="font-family: monospace;">""</span> (none)<span style="font-family: monospace;"></span><br>



<span style="font-family: monospace;"></span><span style="font-family: monospace;"></span>&nbsp;&nbsp; <span style="font-family: monospace;">"lineColor": </span>color<span style="font-family: monospace;">,</span> // if border; default black<br>




&nbsp;&nbsp; <span style="font-family: monospace;">"lineWidth": </span>width<sub>number</sub><span style="font-family: monospace;">,</span> // if border; default 1<br>



<span style="font-family: monospace;"></span>&nbsp;&nbsp; <span style="font-family: monospace;">"fillColor": </span>color<span style="font-family: monospace;">,</span> // if fill; default black<br>




&nbsp;&nbsp; <span style="font-family: monospace;">"textVAlign": </span><span style="font-family: monospace;">"above" </span>| <span style="font-family: monospace;">"top"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"middle"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"bottom"</span><span style="font-family: monospace;"></span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"below"</span><span style="font-family: monospace;">,</span> // default "middle"<span style="font-family: monospace;"></span><br>






<span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span>

&nbsp;&nbsp; <span style="font-family: monospace;">"textHAlign": </span><span style="font-family: monospace;">"left" </span>| <span style="font-family: monospace;">"centre"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"right"</span><span style="font-family: monospace;">,</span> // default "centre"<br>


<span style="font-family: monospace;"></span>&nbsp;&nbsp;

<span style="font-family: monospace;">"textHFit": </span><span style="font-family: monospace;">"wrap" </span>| <span style="font-family: monospace;">"crop"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"scale"</span><span style="font-family: monospace;"> </span>| <span style="font-family: monospace;">"none"</span><span style="font-family: monospace;">,</span> // default "none"<br>







<span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;">}</span><br>
<p style="font-style: italic;">A sequence</p>sequence:= <span style="font-family: monospace;">{</span><br>&nbsp; &nbsp; <span style="font-family: monospace;">"id": </span>id<sub>number</sub><span style="font-family: monospace;">,</span><br>&nbsp; &nbsp; <span style="font-family: monospace;">"description": </span>description<sub>string</sub><span style="font-family: monospace;">,</span><br>&nbsp; &nbsp; <span style="font-family: monospace;">"items": [ </span>sequenceItem* <span style="font-family: monospace;">]</span><br><span style="font-family: monospace;">}</span><br><p style="font-style: italic;">An item in a sequence</p>sequenceItem:= <span style="font-family: monospace;">{</span><br>&nbsp; &nbsp; <span style="font-family: monospace;">"id": </span>id<sub>int</sub><span style="font-family: monospace;">,</span><br>&nbsp; &nbsp; <span style="font-family: monospace;">"channel": </span>channel<sub>int</sub><span style="font-family: monospace;">,</span> // default: <span style="font-family: monospace;">0</span><br style="font-family: monospace;">// One of:<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="font-family: monospace;">"text": </span>text // may only have content<br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="font-family: monospace;">"frameRef": { "sketchId": </span>id<sub>number</sub><span style="font-family: monospace;">, "elementId": </span>id<sub>number</sub><span style="font-family: monospace;"> }</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="font-family: monospace;">"sketchRef": { "sketchId": </span>id<sub>number<span style="font-family: monospace;"> </span></sub><span style="font-family: monospace;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="font-family: monospace;">"sequenceRef": { "sequenceId": </span>id<sub>number<span style="font-family: monospace;"> </span></sub><span style="font-family: monospace;">}</span><br>&nbsp; &nbsp; &nbsp; &nbsp; <span style="font-family: monospace;">"toFrameRef": { "sketchId": </span>id<sub>number</sub><span style="font-family: monospace;">, "elementId": </span>id<sub>number</sub><span style="font-family: monospace;"> }</span><br>}<h3>Sketcher1 file format</h3>

<span style="font-style: italic;">The complete state of the sketch and editor, as saved</span><br style="font-style: italic;">
state := <span style="font-family: monospace;">{</span> <br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"nextObjectId": </span>nextObjectId<sub>int</sub><span style="font-family: monospace;">, </span> // numeric (integer) ID to be allocated to next object created<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"objects": [</span> object* <span style="font-family: monospace;">],</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"selectionHistory": [ </span>selection* <span style="font-family: monospace;">]</span><br>
<span style="font-family: monospace;">}</span><br>
<span style="font-style: italic;">A single 'object' or page within the 'sketch'; currently combines interface state as well as drawing state.</span><br style="font-style: italic;">
object := <span style="font-family: monospace;">{</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"id": </span>id<sub>int</sub>, // numeric (integer) ID of this object<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"editorVisible": true, </span>// iff object is currently visible in UI top-most editor view<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"editorSettings":</span> editorSettings<span style="font-family: monospace;">,</span> // optional<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"editorRank":</span> editorRank<sub>int</sub>, // optional, position (integer) of editor view for this object in tab list (if present)<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"description": </span>description<sub>string</sub><span style="font-family: monospace;">,</span> // first line of description (to first \n, if any) is name/title of object<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"symbol":</span> item <br>
}<br>
<span style="font-style: italic;">Part of interface state - current drawing views.</span> - should not be present on a Path?!<br style="font-style: italic;">
editorSettings := <span style="font-family: monospace;">{</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"detailZoom": </span>zoom<sub>number</sub><span style="font-family: monospace;">, </span>// ratio<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"detailCenter": { "x": </span>x<sub>number</sub><span style="font-family: monospace;">, "y": </span>y<sub>number</sub> <span style="font-family: monospace;">}, </span>// assumed type (paperj2.Point2D) - currently (2012-111-20) not written correctly<br>
&nbsp;&nbsp;&nbsp;<span style="font-family: monospace;"> "overviewZoom": </span>zoom<sub>number</sub><span style="font-family: monospace;">,</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"overviewCenter": { "x": </span>x<sub>number</sub><span style="font-family: monospace;">, "y": </span>y<sub>number</sub> <span style="font-family: monospace;">}</span> // assumed - currently (2012-111-20) not written correctly<br>
<span style="font-family: monospace;">}</span><br>
<span style="font-style: italic;">Primitive element within a drawing/object</span><br style="font-style: italic;">
item := groupItem or symbolItem or pathItem or textIitem<br>
<span style="font-style: italic;">A group of items, typically with a
transformation. Not currently authored directly by the user, but can be
exported reflecting internal encodings of objects/drawings. Should
perhaps be removed for parsimony.</span><br>
groupItem :=&nbsp; <span style="font-family: monospace;">{</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"type": "group",</span><br>

&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"matrix": </span>matrix<span style="font-family: monospace;">,</span> // optional, transformation<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"children": [</span> item* <span style="font-family: monospace;">]</span><br>
<span style="font-family: monospace;">}</span><br>
<span style="font-style: italic;">A reference to (visual instantiation of) another object, subject to a transformation matrix.</span><br>
symbolItem :=&nbsp; <span style="font-family: monospace;">{</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"type": "symbol",</span><br>


&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"matrix": </span>matrix<span style="font-family: monospace;">,</span> // optional, transformation<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"objid":</span> objectId<sub>int</sub><span style="font-family: monospace;"></span><br>

<span style="font-family: monospace;">}</span><br>
<span style="font-style: italic;">A line, typically curved. Can also encode e.g. rectangle. Directly follows Paperjs Path.</span><br>
pathItem :=&nbsp; <span style="font-family: monospace;">{</span><br>

&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"type": "path",</span><br>


&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"matrix": </span>matrix<span style="font-family: monospace;">,</span> // optional, transformation - should not be present on a Path?!<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"strokeColor": </span>color<span style="font-family: monospace;">,</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"fillColor": </span>color<span style="font-family: monospace;">,</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"strokeWidth": </span>strokeWidth<sub>number</sub><span style="font-family: monospace;">,</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"closed": </span>closed<sub>boolean</sub><span style="font-family: monospace;">,</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"clockwise": </span>clockwise<sub>boolean</sub><span style="font-family: monospace;">,</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"segments": [ </span>segment*<span style="font-family: monospace;"> ]</span><br>
<span style="font-family: monospace;">}</span><br>
<span style="font-style: italic;">A single line of text, positioned relative to a point.<br>
</span>textItem :=&nbsp; <span style="font-family: monospace;">{</span><br>

&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"type": "text",</span><br>


&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"matrix": </span>matrix<span style="font-family: monospace;">,</span> // optional, transformation - should not be present on Text?!<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"content": </span>contentstring,<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"point": { "x": </span>x<sub>number</sub><span style="font-family: monospace;">, "y": </span>y<sub>number</sub><span style="font-family: monospace;"> },</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"paragraphStyle": </span>paragraphStyle<span style="font-family: monospace;">,</span> <br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"characterStyle": </span>characterStyle<span style="font-family: monospace;"></span><br>

<span style="font-family: monospace;">}<br>
</span><span style="font-style: italic;">A color in RGB encoding.<br>
</span>color := <span style="font-family: monospace;">{</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"red": </span>red<sub>number</sub><span style="font-family: monospace;"></span><span style="font-family: monospace;">,</span> // Amount of red, between 0 and 1<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"green": </span>green<sub>number</sub><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;">,</span> // Amount of green, between 0 and 1<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"blue": </span>blue<sub>number</sub><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span> // Amount of blue, between 0 and 1<br>
<span style="font-family: monospace;">}</span><br>
<span style="font-style: italic;">A point on a Path (again, based
directly on paperjs). Handles specify relative tangents of
incoming/outgoing edge with respect to point.</span> <br>
segment := <span style="font-family: monospace;">{</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"point": { "x": </span>x<sub>number</sub><span style="font-family: monospace;">, "y": </span>y<sub>number</sub> <span style="font-family: monospace;">}, </span>// refer to paper.js Path segment specification<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"handleIn": { "x": </span>x<sub>number</sub><span style="font-family: monospace;">, "y": </span>y<sub>number</sub><span style="font-family: monospace;"> }, </span><span style="font-family: monospace;"></span>// refer to paper.js Path segment specification<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"handleOut": { "x": </span>x<sub>number</sub><span style="font-family: monospace;">, "y": </span>y<sub>number</sub><span style="font-family: monospace;"> } </span><span style="font-family: monospace;"></span>// refer to paper.js Path segment specification<br>

<span style="font-family: monospace;">}</span><br>

<span style="font-style: italic;">Text paragraph style. May be elaborated in future versions of paperjs.<br>
</span>paragraphStyle := <span style="font-family: monospace;">{</span> <br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"justification": </span>justification // one of <span style="font-family: monospace;">"left"</span>, <span style="font-family: monospace;">"right"</span> or <span style="font-family: monospace;">"center"</span><br>
<span style="font-family: monospace;">}</span><br>
<span style="font-style: italic;">Text character style. <br>
</span>characterStyle := <span style="font-family: monospace;">{</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"fontSize": </span>fontSize<sub>number</sub><span style="font-family: monospace;">,<span style="font-family: monospace;"></span></span> // font size in points - presumably CSS defined, i.e. 1pt = (nominal) 1/72nd of 1in, and 4/3rd CSS (nominal) pixels<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"fillColor": </span>color<span style="font-family: monospace;">,</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"font": </span>font // name of font family, e.g. <span style="font-family: monospace;">"sans-serif"</span><br>
<span style="font-family: monospace;">}<span style="font-style: italic;"></span><br>
</span><span style="font-style: italic;">Transformation matrix, especially for symbol reference.</span><br>
matrix := <span style="font-family: monospace;">[</span><br>
&nbsp;&nbsp;&nbsp; a<sub>number</sub><span style="font-family: monospace;">,</span> // The scaleX coordinate of the transform<br>
&nbsp;&nbsp;&nbsp; b<sub>number</sub><span style="font-family: monospace;">,</span> // The shearY coordinate of the transform<br>

&nbsp;&nbsp;&nbsp; c<sub>number</sub><span style="font-family: monospace;">,</span> // The shearX coordinate of the transform<br>

&nbsp;&nbsp;&nbsp; d<sub>number</sub><span style="font-family: monospace;">,</span> // The scaleY coordinate of the transform<br>

&nbsp;&nbsp;&nbsp; tx<sub>number</sub><span style="font-family: monospace;">,</span> // The translateX coordinate of the transform<br>

&nbsp;&nbsp;&nbsp; ty<sub>number</sub><span style="font-family: monospace;">,</span> // The translateY coordinate of the transform<br>
<span style="font-family: monospace;">]</span><br>
<span style="font-style: italic;">Selection history - part of interface state, and only very slightly supported at present (2012-11-20).</span><br>
selection := <span style="font-family: monospace;">{</span><br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"objid": </span>objid<sub>int</sub><span style="font-family: monospace;">,</span> // selection item object ID<br>
&nbsp;&nbsp;&nbsp; <span style="font-family: monospace;">"current": </span>current<sub>boolean</sub> // whether selection item is current, i.e. active as selection to place, etc.<br>
&nbsp;&nbsp;&nbsp; // ? non-object selections ? selection with .item set currently omitted from save!<br>
<span style="font-family: monospace;">}</span><br>
<h3>Sketcher1 Additional notes</h3>
<h4>Frames</h4>
A frame is currently modeled as:<br>
<ul>
  <li>paperjs Group <br>
  </li>
  <ul>
    <li>with children</li>
  </ul>
  <ul>
    <ul>
      <li>name 'frameid' - invisible PointText with content 'f'N</li>
      <li>name 'framedescription' - PointText with user-specified frame title as content, centered, grey, top of frame</li>
      <li>name 'frame' - Path (Rectangle) with bounds matching drawn frame size<br>
      </li>
    </ul>
  </ul>
  <ul>
    <li>with matrix that is translation to top-left of drawn frame region<br>
    </li>
  </ul>
</ul>
<h4>Image</h4>
An image is currently modeled in selection (on load) as:<br>
<ul>
  <li>paperjs Group</li>
  <ul>
    <li>with child</li>
    <ul>
      <li>paperjs Raster (=image)</li>
    </ul>
    <li>with matrix to fit to selection item bounds<br>
    </li>
  </ul>
</ul>
but seems to be modeled in an object as:<br>
<ul>
  <li>paperjs Raster (=image)</li>
  <ul>
    <li>with zoom and position to place image</li>
  </ul>
</ul>
<h4>Sequences</h4>
There is a note in some comments that<br>
sequences := [ sequence* ]<br>
sequence := {<br>
&nbsp;&nbsp;&nbsp; "id": id // unique for all frames and sequences on all objects<br>
&nbsp;&nbsp;&nbsp; "description": string<br>
&nbsp;&nbsp;&nbsp; "items": [ sequenceItem ]<br>
}<br>
sequenceItem := {<br>
&nbsp;&nbsp;&nbsp; "id" : id // of frame/sequence<br>
&nbsp;&nbsp;&nbsp; "type": type // one of "sequence" or "frame"<br>


&nbsp;&nbsp;&nbsp; "objid" : id // optional, of object<br>
}<br>
But that is clearly incomplete (and not implemented)<br>
 </body></html>